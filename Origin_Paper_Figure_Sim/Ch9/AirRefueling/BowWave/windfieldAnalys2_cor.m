function [phi]=windfieldAnalys2_cor(x,y)


V=120;

ff=quad(@(z)intTest(z,x,y),0.1,3);
%ff=0.024*atan((0.1232*x - 2.0*x*(0.028*x + 0.012) + 0.0528)/(0.024*y + 0.056*x*y)) - 0.024*atan((0.00424827*x - 2.0*x*(0.028*x + 0.012) + 0.00182069)/(0.024*y + 0.056*x*y)) + 0.028*y*log(x^2 - 4.4*x + y^2 + 4.84) - 0.028*y*log(x^2 - 0.151724*x + y^2 + 0.00575504) - x*(0.056*atan((0.00424827*x - 2.0*x*(0.028*x + 0.012) + 0.00182069)/(0.024*y + 0.056*x*y)) - 0.056*atan((0.1232*x - 2.0*x*(0.028*x + 0.012) + 0.0528)/(0.024*y + 0.056*x*y)));
%ff=0.03*atan((0.224*x - 2.0*x*(0.0448*x + 0.015) + 0.075)/(0.03*y + 0.0896*x*y)) - 0.03*atan((0.001792*x - 2.0*x*(0.0448*x + 0.015) + 0.0006)/(0.03*y + 0.0896*x*y)) + x*(0.0896*atan((0.224*x - 2.0*x*(0.0448*x + 0.015) + 0.075)/(0.03*y + 0.0896*x*y)) - 0.0896*atan((0.001792*x - 2.0*x*(0.0448*x + 0.015) + 0.0006)/(0.03*y + 0.0896*x*y))) + 0.0448*y*log(x^2 - 5.0*x + y^2 + 6.25) - 0.0448*y*log(x^2 - 0.04*x + y^2 + 0.0004);
%m0=0.03;m1=0.09;r2=2.5;r1=0.075;
%ff=0.5*m1*y*log(((r2-x)/y)^2+1)-0.5*m1*y*log(((r1-x)/y)^2+1)+(m0+m1*x)*atan((r2-x)/y)-(m0+m1*x)*atan((r1-x)/y);
phi=V*y-V*ff;
if y<0 && phi>=0
    phi=0;
end

if x>=0
    phi=phi/V;
else
    phi=sqrt((phi)^2+(V*x)^2)/V;
end

% ff1=(7836967177122249*log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (6559710489514517*y)/579703333937333888 + 3317557317312193/576460752303423488))/284650466326237888 - (4728772245756805*atan(((191821791221638597497481495321096833870866677760*x)/4447663536347467 + (14386611940804592060757333211608042278148374528*y)/4447663536347467 - 138788041935783767218338203172864)/((14386611940804592060757333211608042278148374528*x)/4447663536347467 - (191821791221638597497481495321096833870866677760*y)/4447663536347467)))/569300932652475776 + (4728772245756805*atan(((191821791221638597497481495321096833870866677760*x)/4447663536347467 + (14386611940804592060757333211608042278148374528*y)/4447663536347467 - 3290231195379014967809697382400)/((14386611940804592060757333211608042278148374528*x)/4447663536347467 - (191821791221638597497481495321096833870866677760*y)/4447663536347467)))/569300932652475776 - (7836967177122249*log((4503599627370496*x^2)/4528932296385421 - (36028797018963968*x)/5661165370481777 + (4503599627370496*y^2)/4528932296385421 - (5404311138007777*y)/11322330740963554 + 256/25))/284650466326237888 + ((277760231023655261260390552120350898632954463911936*x)/2846504663262379 + (76828327177018852761937913389667092532248537202688*y)/2846504663262379 - (27127906702808273023203515078918068671026546343936*x^2)/759067910203301 - (27127906702808273023203515078918068671026546343936*y^2)/759067910203301 + 49288420184562343281463696612655104)/(649037107316853453566312041152512000*x^2 - 4153837486827862102824397063376076800*x + 649037107316853453566312041152512000*y^2 - 311537326429773400840888371342475264*y + 6683524399886365316244883492409704448) + ((27127906702808273023203515078918068671026546343936*x^2)/759067910203301 + (9723086080328912767217003501593189479102002757632*x)/759067910203301 + (27127906702808273023203515078918068671026546343936*y^2)/759067910203301 - (4039867854368033583666203825581032345393025777664*y)/2277203730609903 - 1168474570289209639076092580986880)/(649037107316853453566312041152512000*x^2 - 98474519051284417057827136636715008*x + 649037107316853453566312041152512000*y^2 - 7385577429058978734905635421290496*y + 3756248119871242411208113435705344);
% 
% vx=eval(subs(ff1))*V;
% 
% 
% ff2=(4728772245756805*log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (6559710489514517*y)/579703333937333888 + 3317557317312193/576460752303423488))/1138601865304951552 + (7836967177122249*atan(((1271620626694137797962664769324284468954369359872*x)/4447663536347467 + (95371398503068496000819567279154653759709118464*y)/4447663536347467 - 920050510111830437128000453476352)/((95371398503068496000819567279154653759709118464*x)/4447663536347467 - (1271620626694137797962664769324284468954369359872*y)/4447663536347467)))/142325233163118944 - (7836967177122249*atan(((1271620626694137797962664769324284468954369359872*x)/4447663536347467 + (95371398503068496000819567279154653759709118464*y)/4447663536347467 - 21811525312065242572871394394112)/((95371398503068496000819567279154653759709118464*x)/4447663536347467 - (1271620626694137797962664769324284468954369359872*y)/4447663536347467)))/142325233163118944 - (4728772245756805*log((4503599627370496*x^2)/4528932296385421 - (36028797018963968*x)/5661165370481777 + (4503599627370496*y^2)/4528932296385421 - (5404311138007777*y)/11322330740963554 + 256/25))/1138601865304951552 - ((12276594638184870239838815700550197367735467376640*x^2)/2277203730609903 - (70214585962031189493785947731316926195598928904192*x)/2846504663262379 + (12276594638184870239838815700550197367735467376640*y^2)/2277203730609903 + (365943584530051298623011186890718403581300046823424*y)/2846504663262379 - 7435073675131273176928923563327488)/(649037107316853453566312041152512000*x^2 - 4153837486827862102824397063376076800*x + 649037107316853453566312041152512000*y^2 - 311537326429773400840888371342475264*y + 6683524399886365316244883492409704448) + ((12276594638184870239838815700550197367735467376640*x^2)/2277203730609903 + (1251125117622097258018356261997809472135875264512*x)/2277203730609903 + (12276594638184870239838815700550197367735467376640*y^2)/2277203730609903 + (41377424564130099896120470967238641170164584808448*y)/2277203730609903 - 176262385466732940763441257250816)/(649037107316853453566312041152512000*x^2 - 98474519051284417057827136636715008*x + 649037107316853453566312041152512000*y^2 - 7385577429058978734905635421290496*y + 3756248119871242411208113435705344);
% 
% vy=eval(subs(ff2))*V;



