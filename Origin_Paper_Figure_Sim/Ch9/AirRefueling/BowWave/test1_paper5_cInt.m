[x1,y1]=meshgrid(-1.5:0.05:3,-0.5:0.01:0.5);
syms x y;
%ff=log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (6559710489514517*y)/579703333937333888 + 3317557317312193/576460752303423488)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) - log((4503599627370496*x^2)/4528932296385421 - (2251799813685248*x)/353822835655111 + (4503599627370496*y^2)/4528932296385421 - (5404311138007777*y)/11322330740963552 + 256/25)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + atan(((2543241253388275595925329538648568937908738719744*x)/2764240903555555 + (76728716488655438998992598128438733548346671104*y)/552848180711111 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((7836967177122249*x)/284650466326237888 + (4728772245756805*y)/1138601865304951552 + 6878835697339317/576460752303423488) + 398768398735474798995214566424576)/((15576890575604482885591488987660288*y)/125 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + (11988861951352412343592593457568552116929167360*x^2)/552848180711111 + (11988861951352412343592593457568552116929167360*y^2)/552848180711111))*((7836967177122249*x)/142325233163118944 + (4728772245756805*y)/569300932652475776 + 6878835697339317/288230376151711744) - atan(((12058462087309617052951585484570982948133666816*x)/552848180711111 + (1818998330484232381802162834265945028356472832*y)/552848180711111 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((7836967177122249*x)/284650466326237888 + (4728772245756805*y)/1138601865304951552 + 6878835697339317/576460752303423488) + 9453553828923303786214517112832)/((15576890575604482885591488987660288*y)/125 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + (11988861951352412343592593457568552116929167360*x^2)/552848180711111 + (11988861951352412343592593457568552116929167360*y^2)/552848180711111))*((7836967177122249*x)/142325233163118944 + (4728772245756805*y)/569300932652475776 + 6878835697339317/288230376151711744) - 7521639463514959/576460752303423488;

ff=log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (29542309716235913523220407517933*y)/2610751718705611105781706232168448 + 29881899796054911618044483350441/5192296858534827628530496329220096)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) - atan(((12058462087309617556338385955105101346060107776*x)/552848180711111 + (1818998330484232284361861976355183043626926080*y)/552848180711111 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((7836967177122249*x)/284650466326237888 + (4728772245756805*y)/1138601865304951552 + 6878835697339317/576460752303423488) + 18907107657846607389551524124889/2)/((15576890575604482885591488987660288*y)/125 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + (11988861951352412343592593457568552116929167360*x^2)/552848180711111 + (11988861951352412343592593457568552116929167360*y^2)/552848180711111))*((7836967177122249*x)/142325233163118944 + (4728772245756805*y)/569300932652475776 + 6878835697339317/288230376151711744) - log((4503599627370496*x^2)/4528932296385421 - (99079191802150912*x)/22644661481927105 + (4503599627370496*y^2)/4528932296385421 - (59447422518085547*y)/181157291855416840 + 121/25)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + atan(((1748478361704439472198664057820891144812257869824*x)/2764240903555555 + (52750992585950614311807411213301629314488336384*y)/552848180711111 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((7836967177122249*x)/284650466326237888 + (4728772245756805*y)/1138601865304951552 + 6878835697339317/576460752303423488) + 1370766370653194522466858269933568/5)/((15576890575604482885591488987660288*y)/125 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((4728772245756805*x)/1138601865304951552 - (7836967177122249*y)/284650466326237888 + 8254589983915121/9223372036854775808) + (11988861951352412343592593457568552116929167360*x^2)/552848180711111 + (11988861951352412343592593457568552116929167360*y^2)/552848180711111))*((7836967177122249*x)/142325233163118944 + (4728772245756805*y)/569300932652475776 + 6878835697339317/288230376151711744) - 723787170719935801734060721016511/81585991209550352676170654713643008;

% ff1=(7836967177122249*log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (6559710489514517*y)/579703333937333888 + 3317557317312193/576460752303423488))/284650466326237888 - (4728772245756805*atan(((191821791221638597497481495321096833870866677760*x)/4447663536347467 + (14386611940804592060757333211608042278148374528*y)/4447663536347467 - 138788041935783767218338203172864)/((14386611940804592060757333211608042278148374528*x)/4447663536347467 - (191821791221638597497481495321096833870866677760*y)/4447663536347467)))/569300932652475776 + (4728772245756805*atan(((191821791221638597497481495321096833870866677760*x)/4447663536347467 + (14386611940804592060757333211608042278148374528*y)/4447663536347467 - 3290231195379014967809697382400)/((14386611940804592060757333211608042278148374528*x)/4447663536347467 - (191821791221638597497481495321096833870866677760*y)/4447663536347467)))/569300932652475776 - (7836967177122249*log((4503599627370496*x^2)/4528932296385421 - (36028797018963968*x)/5661165370481777 + (4503599627370496*y^2)/4528932296385421 - (5404311138007777*y)/11322330740963554 + 256/25))/284650466326237888 + ((277760231023655261260390552120350898632954463911936*x)/2846504663262379 + (76828327177018852761937913389667092532248537202688*y)/2846504663262379 - (27127906702808273023203515078918068671026546343936*x^2)/759067910203301 - (27127906702808273023203515078918068671026546343936*y^2)/759067910203301 + 49288420184562343281463696612655104)/(649037107316853453566312041152512000*x^2 - 4153837486827862102824397063376076800*x + 649037107316853453566312041152512000*y^2 - 311537326429773400840888371342475264*y + 6683524399886365316244883492409704448) + ((27127906702808273023203515078918068671026546343936*x^2)/759067910203301 + (9723086080328912767217003501593189479102002757632*x)/759067910203301 + (27127906702808273023203515078918068671026546343936*y^2)/759067910203301 - (4039867854368033583666203825581032345393025777664*y)/2277203730609903 - 1168474570289209639076092580986880)/(649037107316853453566312041152512000*x^2 - 98474519051284417057827136636715008*x + 649037107316853453566312041152512000*y^2 - 7385577429058978734905635421290496*y + 3756248119871242411208113435705344);
% ff2=(4728772245756805*log((4503599627370496*x^2)/4528932296385421 - (5466433919481229*x)/36231458371083368 + (4503599627370496*y^2)/4528932296385421 - (6559710489514517*y)/579703333937333888 + 3317557317312193/576460752303423488))/1138601865304951552 + (7836967177122249*atan(((1271620626694137797962664769324284468954369359872*x)/4447663536347467 + (95371398503068496000819567279154653759709118464*y)/4447663536347467 - 920050510111830437128000453476352)/((95371398503068496000819567279154653759709118464*x)/4447663536347467 - (1271620626694137797962664769324284468954369359872*y)/4447663536347467)))/142325233163118944 - (7836967177122249*atan(((1271620626694137797962664769324284468954369359872*x)/4447663536347467 + (95371398503068496000819567279154653759709118464*y)/4447663536347467 - 21811525312065242572871394394112)/((95371398503068496000819567279154653759709118464*x)/4447663536347467 - (1271620626694137797962664769324284468954369359872*y)/4447663536347467)))/142325233163118944 - (4728772245756805*log((4503599627370496*x^2)/4528932296385421 - (36028797018963968*x)/5661165370481777 + (4503599627370496*y^2)/4528932296385421 - (5404311138007777*y)/11322330740963554 + 256/25))/1138601865304951552 - ((12276594638184870239838815700550197367735467376640*x^2)/2277203730609903 - (70214585962031189493785947731316926195598928904192*x)/2846504663262379 + (12276594638184870239838815700550197367735467376640*y^2)/2277203730609903 + (365943584530051298623011186890718403581300046823424*y)/2846504663262379 - 7435073675131273176928923563327488)/(649037107316853453566312041152512000*x^2 - 4153837486827862102824397063376076800*x + 649037107316853453566312041152512000*y^2 - 311537326429773400840888371342475264*y + 6683524399886365316244883492409704448) + ((12276594638184870239838815700550197367735467376640*x^2)/2277203730609903 + (1251125117622097258018356261997809472135875264512*x)/2277203730609903 + (12276594638184870239838815700550197367735467376640*y^2)/2277203730609903 + (41377424564130099896120470967238641170164584808448*y)/2277203730609903 - 176262385466732940763441257250816)/(649037107316853453566312041152512000*x^2 - 98474519051284417057827136636715008*x + 649037107316853453566312041152512000*y^2 - 7385577429058978734905635421290496*y + 3756248119871242411208113435705344);
% ff=-(2725951606260517116124888934907904*z)/652687929676402817778742105212728125 - log((5192296858534827628530496329220096*x^2)/5221503437411222542229936841701825 - (10384593717069655257060992658440192*x*z)/5221503437411222542229936841701825 + (5192296858534827628530496329220096*y^2)/5221503437411222542229936841701825 - (778843316074433461749968267116544*y*z)/5221503437411222542229936841701825 + z^2)*((14153949961704450384575691592344580151863307755463698580101906038784*x)/3408012268362151600552511213214507565310759139531263766045276041328125 - (93829041037907646900030972222771443814295128121932563777984567181312*y)/3408012268362151600552511213214507565310759139531263766045276041328125 + 584132487055825096312476200337408/652687929676402817778742105212728125) - atan(((10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((93829041037907646900030972222771443814295128121932563777984567181312*x)/3408012268362151600552511213214507565310759139531263766045276041328125 + (14153949961704450384575691592344580151863307755463698580101906038784*y)/3408012268362151600552511213214507565310759139531263766045276041328125 + 7788445287802241442795744493830144/652687929676402817778742105212728125) - z*((187658082075815293800061944445542887628590256243865127555969134362624*x)/652687929676402817778742105212728125 + (28307899923408900769151383184689160303726615510927397160203812077568*y)/652687929676402817778742105212728125 + 15576890575604482885591488987660288/125))/((15576890575604482885591488987660288*y)/125 - (10384593717069655257060992658440192*x + 778843316074433461749968267116544*y)*((14153949961704450384575691592344580151863307755463698580101906038784*x)/3408012268362151600552511213214507565310759139531263766045276041328125 - (93829041037907646900030972222771443814295128121932563777984567181312*y)/3408012268362151600552511213214507565310759139531263766045276041328125 + 584132487055825096312476200337408/652687929676402817778742105212728125) + (14153949961704450384575691592344580151863307755463698580101906038784*x^2)/652687929676402817778742105212728125 + (14153949961704450384575691592344580151863307755463698580101906038784*y^2)/652687929676402817778742105212728125))*((187658082075815293800061944445542887628590256243865127555969134362624*x)/3408012268362151600552511213214507565310759139531263766045276041328125 + (28307899923408900769151383184689160303726615510927397160203812077568*y)/3408012268362151600552511213214507565310759139531263766045276041328125 + 15576890575604482885591488987660288/652687929676402817778742105212728125);
% ff1=subs(ff,z,2.2)-subs(ff,z,0.07586201);

V=120;

[nr,nc]=size(x1);
z1=zeros(nr,nc);
for row=1:nr
    for cols=1:nc
%         if x1(row,cols)>-0.1 && y1(row,cols)<0.1*x1(row,cols) && x1(row,cols)<-2.4 && y1(row,cols)>-0.1*x1(row,cols)
%             z1(row,cols)=0;
        if y1(row,cols)<0.01 && y1(row,cols)>-0.01
            z1(row,cols)=0;
        else
            x=x1(row,cols);y=y1(row,cols);
            phi1=eval(subs(ff));
            z1(row,cols)=V*y-V*phi1; 
        
%         x=x1(row,cols);y=y1(row,cols);
%         phi1=eval(subs(ff));
%         z1(row,cols)=V*y-V*phi1;
        %[a,b,z(row,cols)]=windfieldAnalys1(x1(row,cols),y1(row,cols));
        end
    end
end


%z=BowWaveFunc1_paper3(x,y);
v=0:1:5;
contour(x1,y1,z1,v);hold on;
colorbar;