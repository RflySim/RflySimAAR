clear;
clc;

Am=[-0.0075,   0.7497   , 0         ,-9.8060    ,0.0001    ,0      , 0        ,0.0328 , 0     ,  0;
    -0.0005,  -0.8359   , 1         ,  0        , 0        , 0      , 0.5332  , 0     ,  0    ,   0; 
    -0.0009,  -5.9646   ,-1.0141    ,  0        ,0         ,0      , 32.6915 , 0      , 0     ,  0;
    0      ,   0        , 1         ,  0        , 0        , 0     ,  0      ,  0     ,  0    ,   0;
    0      ,  -190      , 0         ,  190      , 0        , 0     ,  0      ,  0     ,  0    ,   0;
    1      ,   0        , 0         ,  0        , 0        , 0     ,  0      ,  0     ,  0    ,   0;
    0.003  ,   25.2125  ,-2.3094    , -31.7293  ,-0.1981   , 0.007 , -16.7439 , 0     ,  0.0998 , -0.0016;
    -73.2933,  911.1005 ,-15.3455   , -993.3827 ,-6.2402  ,-36.9891 ,-1.4066  ,-2.4163 , 2.0984,  6.8588;
    0      ,   0        , 0         ,  0        , -1       , 0     ,  0       , 0     ,  0     ,  0;
    0      ,   0        , 0         ,  0        ,0        ,  1     ,  0       , 0     ,  0     ,  0];

eig(Am)

disp(' ');

%状态变量顺序，与控制变量顺序
disp('状态向量是 v alpha q theta h xd el T');
disp('控制输入是 delta_e  delta_T');

disp(' ');
disp('闭环Am的特征根是：');

%闭环系统的极点
disp(eig(Am))

Bm=[0,0,0,0,0,0,1,0,0,0;
    0,0,0,0,0,0,0,1,0,0]';

KP=[-0.01,-18.7722,1.8698,23.5796,0.1322,-0.0117,3.5775,-0.0001;
    66.4139,-770.9788,10.0429,777.4514,5.0012,32.9934,-4.9789,1.3205];

KI=[0.0574,-0.0032;
    1.4499,6.8357];

Km=[KP,-KI];


%增广系统
AA=Am+Bm*Km

%由增广系统分解出原系统
A=AA(1:8,1:8);
B=Bm(1:8,1:2);

%C用于输出h，和xd
C=-AA(9:10,1:8);


%C1输出空速
C1=[1,0,0,0,0,0,0,0;
    0,0,0,0,0,0,0,0];
D=[0 0 ;0 0];

%第2行是油门输入
[N1N,D1N] = ss2tf(A,B,C1,D,2);
%第一列是速度输出，得到油门速度响应
GTvN = tf(N1N(1,:),D1N)

%原系统的极点
disp('开环A的特征根是：');
disp(eig(A))

%打印油门速度通道零点
disp('速度_油门通道的零点是：');
disp(roots(N1N(1,:)));



