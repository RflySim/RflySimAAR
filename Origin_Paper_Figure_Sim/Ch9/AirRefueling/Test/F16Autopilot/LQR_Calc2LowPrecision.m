clear;


A1=[0	0	393.72	0	-393.72	0	0	0
0	0	0	1	0	0	0	0
0	0	0	0	0	1	0	0
0	0	-32.17	-0.007682722	32.44020605	0.285528259	0.001570007	0.102103771
0	0	0	-0.000244229	0.211639843	0.931953037	0	-0.001244788
0	0	0	0	-0.741053502	-0.799376643	0	-0.083693788
0	0	0	0	0	0	-0.2	0
0	0	0	0	0	0	0	-20.2
];

B1=[0	0
0	0
0	0
0	0
0	0
0	0
0.2	0
0	20.2
];

C=eye(8);
D=zeros(8,0);

C1=[1   0   0   0   0   0   0   0  
 0   1	0	0	0	0	0	0
0   0	57.29577951	0	0	0	0	0
0   0	0	1	0	0	0	0
0   0	0	0	57.29577951	0	0	0
0   0	0	0	0	57.29577951	0	0
];


D1=zeros(6,0);

% Q=diag([0  1 200 20 0 100 0 0]);
% R=diag([0.1 3]);
% [k,p,e]=lqr(A1,B1,Q,R);
% 
% [zz,pp,kk]=ss2zp(A1-B1*k,B1(:,1),C1(3,:),0);
% 
% AA=A1-b1*k;
% CC=C(1:2,:);
% DD=zeros(2,2);



%pp
%k
% 
% 
C_v_theta=C1(1:2,:);

A=[A1,zeros(8,2);-C_v_theta,zeros(2,2)];
B=[B1;zeros(2,2)];
C=[-C_v_theta,zeros(2,2)];
D=zeros(10,2);

Q=diag([50  50 500 50 50 50 10 0 100 10]);
R=diag([3000 0.1]);
[k,p,e]=lqr(A,B,Q,R);

eig(A-B*k)

Kp=k(:,1:8);
Ki=-k(:,9:10);


 %[zz,pp,kk]=ss2zp(A-B*k,B(:,2),C(2,:),0)

% 
% %Q=diag([50 0 0 0 0 0 0 0 5 50]);
% %R=diag([0.005 100]);
% 
% % Q=diag([50 5 5 5 5 5 0 5 5 50]);
% % R=diag([0.005 100]);
% % 
% % x0=[0 0 0 0 0 0 0 0 ]';
% % 
%  [k,p,e]=lqr(A,B,Q,R);
%  eig(A-B*k)
%  [zz,pp,kk]=ss2zp(A-B*k,B(:,1),C(1,:),0)
%  
%  KP=k(:,1:8);
%  KI=-k(:,9:10);
% 
% %KP(1:2,1:2)=[0 0 ;0 0];
% 
% %eig(A)

