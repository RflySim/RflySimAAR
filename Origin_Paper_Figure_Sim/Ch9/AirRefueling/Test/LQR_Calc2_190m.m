clear;
clc

% 
% A1=[0	0 393.72	0	-393.72	0	0	0
% 0   0 0 1   0   0   0   0    
% 0	0 0	0	0	1	0	0
% 0.000111135	0 -32.17	-0.018054928	-8.065022573	-1.846855155	0.001559526	0.000437475
% 2.52E-06	0 3.76E-15	-0.000409721	-0.667371723	0.927561102	-4.60E-07	-0.001426346
% 7.98E-12	0 0	-1.30E-09	-0.742601	-0.850870526	0	-0.086580984
% 0	0 0	0	0	0	-1	0
% 0	0 0	0	0	0	0	-20.2
% 
% ];
% 
% B1=[0	0
% 0	0
% 0	0
% 0	0
% 0	0
% 0	0
% 1	0
% 0	20.2
% ];

A1=[0	0   623.36	0	-623.36	0	0	0
0   0 0 1   0   0   0   0     
0	0   0	0	0	1	0	0
0.000120743	0   -32.17	-0.012389501	13.81587152	-0.36912601	0.001569246	0.207973068
1.61E-06	0   -5.27E-13	-0.000164959	-0.940161708	0.929837526	-7.84E-08	-0.001982166
1.13E-21	0   0	-1.16E-19	-2.859886625	-1.276103099	0	-0.209174685
0	0   0	0	0	0	-1	0
0	0   0	0	0	0	0	-20.2

];

B1=[0	0
    0  0
0	0
0	0
0	0
0	0
1	0
0	20.2
];


C1=[1	0	0	0	0	0	0	0
0	1	0	0	0	0	0	0
];

%设置单位转换矩阵，转换ft为m，升降舵度为rad
PA1=diag([0.3048 0.3048 1 0.3048 1 1 1 1/180*pi]);

A11=PA1*A1*PA1^-1;
B11=PA1*B1;

%输入转换矩阵，将升降舵输入单位转为rad
PU=[1 0 ;0 1/180*pi];
B12=B11*PU^-1;


%输出h,xd单位为m
C11=[0	0	0	1	0	0	0	0
0	1	0	0	0	0	0	0
];

C0=eye(8);

D=zeros(8,2);

D11=[0 0 ;0 0];
% 
[N1N,D1N] = ss2tf(A11,B12,C11,D11,1);
GTvN = tf(N1N(1,:),D1N)
roots(N1N(1,:))
roots(D1N)

A=[A11;C11];
A=[A,zeros(10,2)];
B=[0 0 0 0 0 0 0 0 1 0]';
C=[1 0 0 0 0 0 0 0 0 0];
DD=1;
% [N1N1,D1N1] = ss2tf(A,B,C,DD);
% GTvN1 = tf(N1N1,D1N1)
% roots(N1N1)
% roots(D1N1)

%Q=diag([500 0 5 40 5 50 0.01 5 10 500]);
%R=diag([0.003 20]);

%Q=diag([50 0 0 0 0 0 0 0 5 50]);
%R=diag([0.005 100]);

% Q=diag([50 5 5 5 5 5 0 5 5 50]);
% R=diag([0.005 100]);
% 
% x0=[0 0 0 0 0 0 0 0 ]';
% 
% [k,p,e]=lqr(A,B,Q,R);
% eig(A-B*k);
% KP=k(:,1:8);
% KI=k(:,9:10);

%KP(1:2,1:2)=[0 0 ;0 0];

%eig(A)

